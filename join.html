<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
    />
    <title>회원가입 폼</title>
    <link rel="stylesheet" href="join.css" />
  </head>
  <body>
    <button class="toggle-btn" onclick="toggleDarkMode()">🌙 다크 모드</button>

    <fieldset>
      <form onsubmit="return handleSubmit(event)">
        <legend>회원 가입</legend>

        <label for="id">아이디</label>
        <input type="id" id="id" placeholder="아이디" name="id" required />

        <label for="password">비밀번호</label>
        <input
          type="password"
          id="password"
          placeholder="비밀번호"
          name="password"
          required
        />
        <small id="pwMessage" style="color: red"></small>
        <!-- 비번 메시지 -->

        <label for="pwcheck">비밀번호 확인</label>
        <input
          type="password"
          id="pwcheck"
          placeholder="비밀번호 확인"
          name="pwcheck"
          required
        />
        <small id="pwCheckMessage" style="color: red"></small>
        <!-- 확인 메시지 -->

        <label for="name">이름</label>
        <input
          type="text"
          id="name"
          placeholder="사용자 이름"
          name="name"
          required
        />

        <label for="phone">전화번호</label>
        <input
          type="tel"
          id="phone"
          placeholder="휴대전화 번호"
          name="phone"
          required
        />

        <label for="email">이메일</label>
        <input
          type="id"
          id="email"
          name="email"
          placeholder="예: user@example.com"
          pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
          title="예: user@example.com 형식으로 입력해주세요."
          required
        />

        <label for="job">원하는 직무</label>
        <select id="job" name="job" required>
          <option value="unknown">미정</option>
          <option value="frontend">프론트엔드</option>
          <option value="backend">백엔드</option>
          <option value="design">디자인</option>
          <option value="pm">PM</option>
        </select>

        <div class="mb-3">
          <label class="form-label">성별</label><br />
          <div class="form-check form-check-inline">
            <input
              class="form-check-input"
              type="radio"
              name="gender"
              id="male"
              value="male"
            />
            <label class="form-check-label" for="male">남성</label>
          </div>
          <div class="form-check form-check-inline">
            <input
              class="form-check-input"
              type="radio"
              name="gender"
              id="female"
              value="female"
            />
            <label class="form-check-label" for="female">여성</label>
          </div>
        </div>

        <button type="submit" class="btn btn-primary w-100">가입하기</button>
      </form>
    </fieldset>

    <script>
      function toggleDarkMode() {
        document.body.classList.toggle("dark-mode");
        const btn = document.querySelector(".toggle-btn");
        btn.textContent = document.body.classList.contains("dark-mode")
          ? "☀️ 라이트 모드"
          : "🌙 다크 모드";
      }

      const pwInput = document.getElementById("password");
      const pwCheckInput = document.getElementById("pwcheck");
      const pwMessage = document.getElementById("pwMessage");
      const pwCheckMessage = document.getElementById("pwCheckMessage");

      pwInput.addEventListener("input", () => {
        const pw = pwInput.value;
        const regex = /^(?=.*[a-zA-Z])(?=.*\d).{6,}$/;

        if (pw === "") {
          pwMessage.textContent = "";
        } else if (!regex.test(pw)) {
          pwMessage.textContent =
            "비밀번호는 6자 이상, 영문과 숫자를 포함해야 해요.";
          pwMessage.style.color = "red";
        } else {
          pwMessage.textContent = "✅ 사용 가능한 비밀번호입니다.";
          pwMessage.style.color = "green";
        }
      });

      pwCheckInput.addEventListener("input", () => {
        const pw = pwInput.value;
        const check = pwCheckInput.value;

        if (check === "") {
          pwCheckMessage.textContent = "";
        } else if (pw !== check) {
          pwCheckMessage.textContent = "비밀번호가 일치하지 않아요.";
          pwCheckMessage.style.color = "red";
        } else {
          pwCheckMessage.textContent = "✅ 비밀번호가 일치합니다.";
          pwCheckMessage.style.color = "green";
        }
      });

      function validatePasswords() {
        const pw = pwInput.value;
        const check = pwCheckInput.value;

        const regex = /^(?=.*[a-zA-Z])(?=.*\d).{6,}$/;
        if (!regex.test(pw)) {
          alert("비밀번호 형식을 확인하세요.");
          return false;
        }

        if (pw !== check) {
          alert("비밀번호가 일치하지 않습니다.");
          return false;
        }

        return true;
      }
    </script>
    <script>
      function handleSubmit(event) {
        event.preventDefault();

        if (!validatePasswords()) return false;

        const form = event.target;
        const formData = new FormData(form);
        const userData = {};

        for (const [key, value] of formData.entries()) {
          if (key === "password" || key === "pwcheck") continue; // 비밀번호 제외
          userData[key] = value;
        }

        sessionStorage.setItem("signupData", JSON.stringify(userData));

        window.open("welcome.html", "_blank");

        return false;
      }
    </script>
  </body>
</html>
